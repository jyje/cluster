---
description: Generates git commit messages following project conventions with gitmoji, domain scope in parentheses, English titles and descriptions, and Co-Authored-By Cursor Agent.
globs: "**/*"
alwaysApply: false
---

# Git Commit Policy

When writing or modifying commit messages, AI must intelligently apply the following rules.

## Format
```
<gitmoji> <type>(<domain>): <title>

<description>

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

## Gitmoji Usage

Gitmoji mappings follow the gitmoji standard:

- **üîß** `chore`: Routine maintenance tasks, supplementary work, or minor corrections without intentional functional changes
- **üõ†Ô∏è** `fix`: Intentional functional configuration changes or feature adjustments
- **‚ú®** `feat`: Introduce new features
- **‚úèÔ∏è** `typo`: Fix a typo
- **üêõ** `bug`: Fix a bug
- **‚¨ÜÔ∏è** `dep`: Upgrade dependencies
- **üîê** `security`: Add or update secrets
- **üóëÔ∏è** `remove`: Deprecate code that needs to be cleaned up
- **‚ôªÔ∏è** `refactor`: Refactor code
- **üìù** `docs`: Add or update documentation
- **üé®** `style`: Improve structure / format of the code
- **‚ö°** `perf`: Improve performance
- **‚úÖ** `test`: Add, update, or pass tests
- **üî®** `build`: Add or update development scripts

> Reference: [gitmoji.dev](https://gitmoji.dev/) - An emoji guide for your commit messages

## Type and Domain
- **Type**: `feat`, `fix`, `bug`, `typo`, `refactor`, `dep`, `security`, `remove`, `chore`, `docs`, `style`, `perf`, `test`, `build`
- **Domain**: Component name in parentheses, lowercase, kebab-case if needed (e.g., `(nfs)`, `(open-webui)`, `(milvus)`, `(argo-cd)`)

## Title & Description
- **Language**: Always English
- **Style**: Concise, imperative mood, start with lowercase after type
- **Description**: Optional, explain "why" or provide context

## Co-Authored-By
Always include: `Co-Authored-By: Cursor Agent <cursoragent@cursor.com>`

## Intelligence Selection
- This rule is activated only when executing `git commit` commands or when commit message writing is needed.
- Ignore this rule during simple code modifications and focus on the task at hand.

## AI Commit Workflow

When the user requests a git commit, AI must follow this workflow:

**Note**: While commit messages must always be in English (as per the policy), the interaction with the user (questions, confirmations, explanations) should match the user's language preference.

1. **Propose commit message in markdown format**: 
   - Generate a commit message following the format and conventions above
   - Present it as a markdown-formatted code block for easy review
   - Include the full message with title, description (if needed), and Co-Authored-By tag

2. **Request user confirmation**:
   - Ask the user if they want to proceed with the commit using the proposed message
   - Wait for explicit approval before executing `git commit`
   - If the user requests changes, revise the message accordingly

3. **Push only after confirmation**:
   - After committing, ask the user if they want to push to the remote repository
   - Only execute `git push` after receiving explicit user approval
   - Never push automatically without user confirmation

Example interaction:
```
AI: "### Proposed commit message:

\`\`\`
üõ†Ô∏è fix(nfs): update configuration settings

Update NFS mount options to improve performance.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
\`\`\`

Proceed with this commit message?"

User: "Yes"

AI: [executes git commit]

AI: "Commit completed. Push to remote repository?"

User: "Yes"

AI: [executes git push]
```

## Examples

Based on project commit history, here are examples following the current policy:

**Feature addition:**
```
‚ú® feat(n8n): add n8n application

Add n8n workflow automation application to the cluster.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

**Intentional functional configuration change:**
```
üõ†Ô∏è fix(nfs): rollback health probes and chart rename to fix distroless image compatibility

Revert recent changes including health probes and chart renaming because the
distroless image lacks 'sh' and other shell utilities required for probes.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

**Routine maintenance:**
```
üîß chore(helm): remove deprecated Helm chart versions and clean up configuration files

Remove old chart versions and clean up unused configuration files for homer applications.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

**Bug fix:**
```
üêõ bug(open-webui): resolve inconsistencies in git commit policy rule

Fix three bugs in the git commit policy rule:
1. Translate Korean text to English to match the 'Always English' policy
2. Clarify gitmoji mapping conflicts
3. Add missing types to the Type list

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

**Dependency update:**
```
‚¨ÜÔ∏è dep(open-webui): update chart to 10.2.1 from 8.10.0

Upgrade open-webui Helm chart to latest version.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

**Refactoring:**
```
‚ôªÔ∏è refactor(nfs): rename custom Helm chart with -jyje suffix and add health probes

Rename Helm chart directory and add health probe configurations.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

**Security:**
```
üîê security(open-webui): add CORS_ALLOW_ORIGIN environment variable for enhanced security

Configure CORS settings to restrict allowed origins.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```

**Typo fix:**
```
‚úèÔ∏è typo(docs): fix typo in gitmoji standard reference

Correct "gitmodi" to "gitmoji" in documentation.

Co-Authored-By: Cursor Agent <cursoragent@cursor.com>
```